!function(t){"use strict";if("undefined"!=typeof WPGlobusWidgets){var e={init:function(){e.addElements(),e.attachListeners()},wysiwygClean:function(){t(".wpglobus-dialog-field").each(function(e,i){var a=t(i).data("source-id");if(1==t("#"+a+"-tmce").size()){var d=t(i).next(".wpglobus_dialog_start");t(i).remove(),t(d).remove()}})},addElements:function(i,a){var d,n=[];n[0]='input[type="text"]',n[1]="textarea",void 0===i||"class"==i?(d=".widget-liquid-right .widget .widget-content",t.each(n,function(t,i){e.make_clone(d,i)})):"id"==i&&(d="#"+a+" .widget-content",t.each(n,function(t,i){e.make_clone(d,i)}))},make_clone:function(e,i){t(e+" "+i).each(function(e,a){var d,n,o,l,s=t(a),u=!1;if(void 0===(l=s.attr("id"))||-1!=l.indexOf("-number")||""==l)return!0;if(_.each(WPGlobusWidgets.disabledMask,function(t){if(-1!=l.indexOf(t))return u=!0,!1}),u)return!0;if(d=t("#"+l).clone(),t(s).addClass("wpglobus-dialog-field-source hidden"),n=s.attr("name"),t(d).attr("id","wpglobus-"+l),t(d).attr("name","wpglobus-"+n),t(d).attr("data-source-id",l),t(d).attr("class","wpglobus-dialog-field"),t(d).attr("style","width:90%;"),o=WPGlobusCore.TextFilter(t(s).val(),WPGlobusCoreData.language),t(d).val(o),t('<div style="width:20px;" data-type="control" data-source-type="" data-source-id="'+l+'" class="wpglobus-widgets wpglobus_dialog_start wpglobus_dialog_icon"></div>').insertAfter(s),t(d).insertAfter(s),'input[type="text"]'==i&&""!=o){var r=s.parents(".widget").attr("id");t("#"+r+" .in-widget-title").text(": "+o)}})},attachListeners:function(){t(document).ajaxComplete(function(i,a,d){if(-1!=d.data.indexOf("action=save-widget"))if(-1!=d.data.indexOf("delete_widget=1"));else{var n=d.data.split("widget-id=");n=n[1].split("&"),t(".widget-liquid-right .widget").each(function(i,a){var d=t(a).attr("id");-1!==d.indexOf(n[0])&&(e.addElements("id",d),e.wysiwygClean())})}}),t("body").on("change",".wpglobus-dialog-field",function(){var e,i=t(this),a="#"+i.data("source-id"),d="",n="";void 0!==a&&(d=t(a).val(),/(\{:|\[:|<!--:)[a-z]{2}/.test(d)?(t.each(WPGlobusCoreData.enabled_languages,function(t,a){""!=(e=a==WPGlobusCoreData.language?i.val():WPGlobusCore.TextFilter(d,a,"RETURN_EMPTY"))&&(n+=WPGlobusCore.addLocaleMarks(e,a))}),t(a).val(n)):t(a).val(i.val()))}),t(document).on("click",".widget-title, .widget-title-action",function(t){t.preventDefault(),e.wysiwygClean()})}};WPGlobusWidgets=t.extend({},WPGlobusWidgets,e)}}(jQuery);